{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Using Pivot Tables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import transportation_tutorials as tt\n",
    "import pandas as pd\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Questions"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1. Within the Jupiter study area, what is the average distance for bike tours to work?\n",
    "   *(Hint: It is 4.03 miles)*\n",
    "2. What tour purpose has the highest average tour distance? *(Hint: Work tours)*\n",
    "2. What is the median distance of walking for all tour purposes? *(Hint: 0.548 miles)*"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data\n",
    "\n",
    "To answer the questions, use the following data:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>hh_id</th>\n",
       "      <th>person_id</th>\n",
       "      <th>person_num</th>\n",
       "      <th>person_type</th>\n",
       "      <th>tour_id</th>\n",
       "      <th>tour_category</th>\n",
       "      <th>tour_purpose</th>\n",
       "      <th>orig_mgra</th>\n",
       "      <th>dest_mgra</th>\n",
       "      <th>start_period</th>\n",
       "      <th>end_period</th>\n",
       "      <th>tour_mode</th>\n",
       "      <th>tour_distance</th>\n",
       "      <th>tour_time</th>\n",
       "      <th>atWork_freq</th>\n",
       "      <th>num_ob_stops</th>\n",
       "      <th>num_ib_stops</th>\n",
       "      <th>out_btap</th>\n",
       "      <th>out_atap</th>\n",
       "      <th>in_btap</th>\n",
       "      <th>in_atap</th>\n",
       "      <th>util_1</th>\n",
       "      <th>util_2</th>\n",
       "      <th>util_3</th>\n",
       "      <th>util_4</th>\n",
       "      <th>util_5</th>\n",
       "      <th>util_6</th>\n",
       "      <th>util_7</th>\n",
       "      <th>util_8</th>\n",
       "      <th>util_9</th>\n",
       "      <th>util_10</th>\n",
       "      <th>util_11</th>\n",
       "      <th>util_12</th>\n",
       "      <th>util_13</th>\n",
       "      <th>util_14</th>\n",
       "      <th>util_15</th>\n",
       "      <th>util_16</th>\n",
       "      <th>util_17</th>\n",
       "      <th>util_18</th>\n",
       "      <th>util_19</th>\n",
       "      <th>util_20</th>\n",
       "      <th>prob_1</th>\n",
       "      <th>prob_2</th>\n",
       "      <th>prob_3</th>\n",
       "      <th>prob_4</th>\n",
       "      <th>prob_5</th>\n",
       "      <th>prob_6</th>\n",
       "      <th>prob_7</th>\n",
       "      <th>prob_8</th>\n",
       "      <th>prob_9</th>\n",
       "      <th>prob_10</th>\n",
       "      <th>prob_11</th>\n",
       "      <th>prob_12</th>\n",
       "      <th>prob_13</th>\n",
       "      <th>prob_14</th>\n",
       "      <th>prob_15</th>\n",
       "      <th>prob_16</th>\n",
       "      <th>prob_17</th>\n",
       "      <th>prob_18</th>\n",
       "      <th>prob_19</th>\n",
       "      <th>prob_20</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1690841</td>\n",
       "      <td>4502948</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>MANDATORY</td>\n",
       "      <td>Work</td>\n",
       "      <td>7736</td>\n",
       "      <td>9290</td>\n",
       "      <td>8</td>\n",
       "      <td>29</td>\n",
       "      <td>6</td>\n",
       "      <td>22.261</td>\n",
       "      <td>32.311001</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-1.395076</td>\n",
       "      <td>-998.970825</td>\n",
       "      <td>-2.360061</td>\n",
       "      <td>-2.051275</td>\n",
       "      <td>-2.361161</td>\n",
       "      <td>-1.139561</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-996.401001</td>\n",
       "      <td>-997.447021</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-997.664978</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>0.340576</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000096</td>\n",
       "      <td>0.091587</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.567742</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1690841</td>\n",
       "      <td>4502948</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>AT_WORK</td>\n",
       "      <td>Work-Based</td>\n",
       "      <td>9290</td>\n",
       "      <td>7980</td>\n",
       "      <td>13</td>\n",
       "      <td>14</td>\n",
       "      <td>1</td>\n",
       "      <td>1.910</td>\n",
       "      <td>4.752000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-0.259837</td>\n",
       "      <td>-998.668518</td>\n",
       "      <td>-0.758937</td>\n",
       "      <td>-999.608398</td>\n",
       "      <td>-0.687137</td>\n",
       "      <td>-999.858276</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-5.843162</td>\n",
       "      <td>-28.534241</td>\n",
       "      <td>-8.014107</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-30.581329</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-32.709736</td>\n",
       "      <td>-30.581329</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-32.709736</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>0.555677</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.204790</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.236415</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.002799</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000319</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1690841</td>\n",
       "      <td>4502948</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>AT_WORK</td>\n",
       "      <td>Work-Based</td>\n",
       "      <td>9290</td>\n",
       "      <td>10608</td>\n",
       "      <td>19</td>\n",
       "      <td>23</td>\n",
       "      <td>3</td>\n",
       "      <td>1.357</td>\n",
       "      <td>3.777000</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-0.195235</td>\n",
       "      <td>-998.668518</td>\n",
       "      <td>-0.694335</td>\n",
       "      <td>-999.608398</td>\n",
       "      <td>-0.622535</td>\n",
       "      <td>-999.858276</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-4.755019</td>\n",
       "      <td>-28.262205</td>\n",
       "      <td>-8.655456</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-33.426655</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-31.728464</td>\n",
       "      <td>-33.426655</td>\n",
       "      <td>-1024.000000</td>\n",
       "      <td>-31.728464</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>0.553007</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.203806</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.235279</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.007751</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000157</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1690841</td>\n",
       "      <td>4502949</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>MANDATORY</td>\n",
       "      <td>Work</td>\n",
       "      <td>7736</td>\n",
       "      <td>8289</td>\n",
       "      <td>27</td>\n",
       "      <td>30</td>\n",
       "      <td>4</td>\n",
       "      <td>30.930</td>\n",
       "      <td>55.431000</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-2.548089</td>\n",
       "      <td>-998.970825</td>\n",
       "      <td>-3.130183</td>\n",
       "      <td>-1.918921</td>\n",
       "      <td>-3.237083</td>\n",
       "      <td>-1.397364</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-996.401001</td>\n",
       "      <td>-997.447021</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-997.664978</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>0.068926</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.242591</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.688483</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1690841</td>\n",
       "      <td>4502949</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>MANDATORY</td>\n",
       "      <td>Work</td>\n",
       "      <td>7736</td>\n",
       "      <td>8289</td>\n",
       "      <td>31</td>\n",
       "      <td>36</td>\n",
       "      <td>4</td>\n",
       "      <td>30.930</td>\n",
       "      <td>55.431000</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>-2.493357</td>\n",
       "      <td>-998.970825</td>\n",
       "      <td>-3.075933</td>\n",
       "      <td>-1.860832</td>\n",
       "      <td>-3.182833</td>\n",
       "      <td>-1.339275</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>-996.401001</td>\n",
       "      <td>-997.447021</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-996.244019</td>\n",
       "      <td>-997.664978</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-999.883789</td>\n",
       "      <td>-1001.335999</td>\n",
       "      <td>-999.0</td>\n",
       "      <td>0.068497</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.242703</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.688801</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     hh_id  person_id  person_num  person_type  tour_id tour_category  \\\n",
       "0  1690841    4502948           1            1        0     MANDATORY   \n",
       "1  1690841    4502948           1            1        1       AT_WORK   \n",
       "2  1690841    4502948           1            1        2       AT_WORK   \n",
       "3  1690841    4502949           2            2        0     MANDATORY   \n",
       "4  1690841    4502949           2            2        1     MANDATORY   \n",
       "\n",
       "  tour_purpose  orig_mgra  dest_mgra  start_period  end_period  tour_mode  \\\n",
       "0         Work       7736       9290             8          29          6   \n",
       "1   Work-Based       9290       7980            13          14          1   \n",
       "2   Work-Based       9290      10608            19          23          3   \n",
       "3         Work       7736       8289            27          30          4   \n",
       "4         Work       7736       8289            31          36          4   \n",
       "\n",
       "   tour_distance  tour_time  atWork_freq  num_ob_stops  num_ib_stops  \\\n",
       "0         22.261  32.311001            6             0             0   \n",
       "1          1.910   4.752000            0             0             0   \n",
       "2          1.357   3.777000            0             0             0   \n",
       "3         30.930  55.431000            1             1             0   \n",
       "4         30.930  55.431000            1             0             0   \n",
       "\n",
       "   out_btap  out_atap  in_btap  in_atap    util_1      util_2    util_3  \\\n",
       "0         0         0        0        0 -1.395076 -998.970825 -2.360061   \n",
       "1         0         0        0        0 -0.259837 -998.668518 -0.758937   \n",
       "2         0         0        0        0 -0.195235 -998.668518 -0.694335   \n",
       "3         0         0        0        0 -2.548089 -998.970825 -3.130183   \n",
       "4         0         0        0        0 -2.493357 -998.970825 -3.075933   \n",
       "\n",
       "       util_4    util_5      util_6  util_7  util_8      util_9     util_10  \\\n",
       "0   -2.051275 -2.361161   -1.139561  -999.0  -999.0 -996.401001 -997.447021   \n",
       "1 -999.608398 -0.687137 -999.858276  -999.0  -999.0   -5.843162  -28.534241   \n",
       "2 -999.608398 -0.622535 -999.858276  -999.0  -999.0   -4.755019  -28.262205   \n",
       "3   -1.918921 -3.237083   -1.397364  -999.0  -999.0 -996.401001 -997.447021   \n",
       "4   -1.860832 -3.182833   -1.339275  -999.0  -999.0 -996.401001 -997.447021   \n",
       "\n",
       "      util_11      util_12      util_13     util_14      util_15      util_16  \\\n",
       "0 -996.244019  -996.244019  -997.664978 -999.883789  -999.883789 -1001.335999   \n",
       "1   -8.014107 -1024.000000 -1024.000000  -30.581329 -1024.000000   -32.709736   \n",
       "2   -8.655456 -1024.000000 -1024.000000  -33.426655 -1024.000000   -31.728464   \n",
       "3 -996.244019  -996.244019  -997.664978 -999.883789  -999.883789 -1001.335999   \n",
       "4 -996.244019  -996.244019  -997.664978 -999.883789  -999.883789 -1001.335999   \n",
       "\n",
       "      util_17      util_18      util_19  util_20    prob_1  prob_2    prob_3  \\\n",
       "0 -999.883789  -999.883789 -1001.335999   -999.0  0.340576     0.0  0.000096   \n",
       "1  -30.581329 -1024.000000   -32.709736   -999.0  0.555677     0.0  0.204790   \n",
       "2  -33.426655 -1024.000000   -31.728464   -999.0  0.553007     0.0  0.203806   \n",
       "3 -999.883789  -999.883789 -1001.335999   -999.0  0.068926     0.0  0.000000   \n",
       "4 -999.883789  -999.883789 -1001.335999   -999.0  0.068497     0.0  0.000000   \n",
       "\n",
       "     prob_4    prob_5    prob_6  prob_7  prob_8    prob_9  prob_10   prob_11  \\\n",
       "0  0.091587  0.000000  0.567742     0.0     0.0  0.000000      0.0  0.000000   \n",
       "1  0.000000  0.236415  0.000000     0.0     0.0  0.002799      0.0  0.000319   \n",
       "2  0.000000  0.235279  0.000000     0.0     0.0  0.007751      0.0  0.000157   \n",
       "3  0.242591  0.000000  0.688483     0.0     0.0  0.000000      0.0  0.000000   \n",
       "4  0.242703  0.000000  0.688801     0.0     0.0  0.000000      0.0  0.000000   \n",
       "\n",
       "   prob_12  prob_13  prob_14  prob_15  prob_16  prob_17  prob_18  prob_19  \\\n",
       "0      0.0      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n",
       "1      0.0      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n",
       "2      0.0      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n",
       "3      0.0      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n",
       "4      0.0      0.0      0.0      0.0      0.0      0.0      0.0      0.0   \n",
       "\n",
       "   prob_20  \n",
       "0      0.0  \n",
       "1      0.0  \n",
       "2      0.0  \n",
       "3      0.0  \n",
       "4      0.0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tour = pd.read_csv(tt.data('SERPM8-BASE2015-TOURS'))\n",
    "tour.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [],
   "source": [
    "tour_mode_dict = {\n",
    "    1: \"DRIVEALONEFREE\",\n",
    "    2: \"DRIVEALONEPAY\",\n",
    "    3: \"SHARED2GP\",\n",
    "    4: \"SHARED2PAY\",\n",
    "    5: \"SHARED3GP\",\n",
    "    6: \"SHARED3PAY\",\n",
    "    7: \"TNCALONE\",\n",
    "    8: \"TNCSHARED\",\n",
    "    9: \"WALK\",\n",
    "    10: \"BIKE\",\n",
    "    11: \"WALK_MIX\",\n",
    "    12: \"WALK_PRMW\",\n",
    "    13: \"WALK_PRMD\",\n",
    "    14: \"PNR_MIX\",\n",
    "    15: \"PNR_PRMW\",\n",
    "    16: \"PNR_PRMD\",\n",
    "    17: \"KNR_MIX\",\n",
    "    18: \"KNR_PRMW\",\n",
    "    19: \"KNR_PRMD\",\n",
    "    20: \"SCHBUS\",\n",
    "}"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
